---
title: A React Hook To Detect An Element Out Of focus
date: 2020-08-18
published: true
author: Tylor Kolbeck
tags: ["react", "hooks", "javascript"]
---

## The Problem

In a recent project I needed a way to detect focus and blur of a react component so that I could conditionally render another element. For example, if I had a custom dropdown element that when focused would display another element containing the options for the user to select. Once the user clicked outside the element, tabbed out or hit enter on after selecting a choice then the dropdown would be hidden.

You can also clone the code from the repo. [Github Source](https://github.com/tylorkolbeck/clickOutside/blob/master/clickOutside.js)

I wanted to be able to reuse this logic across multiple projects so this is the hook that I came up with:

## The Code

```javascript
import { useEffect, useRef, useState } from "react"

const useClickOutside = initialIsVisible => {
  const [isVisible, setIsVisible] = useState(initialIsVisible)
  const ref = useRef(null)

  const handleClickOutside = event => {
    if (ref.current && !ref.current.contains(event.target)) {
      setIsVisible(false)
    }
  }

  const tabOrEscapeHandler = event => {
    if (event.keyCode == 9 || event.keyCode == 27) {
      setIsVisible(false)
    }
  }

  useEffect(() => {
    document.addEventListener("click", handleClickOutside, true)
    document.addEventListener("keydown", tabOrEscapeHandler, true)
    return () => {
      document.removeEventListener("click", handleClickOutside, true)
      document.removeEventListener("keydown", tabOrEscapeHandler, true)
    }
  })
  return { ref, isVisible, setIsVisible }
}

export default useClickOutside
```

## Code Breakdown

I export three variables

- ref
- isVisible
- setIsVisible

All you need to do is give the element that you want to "focus spy" the ref and whenever that component is focused, isVisible will be set to true. Once you unfocus or "blur" then isVisible will be false. I also export setIsVisible incase you would need to manually set the visibility of your component.

Then all you have to do is conditionally render your selected component based on the `isVisible` state.
